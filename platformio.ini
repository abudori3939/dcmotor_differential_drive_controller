; PlatformIO Project Configuration File
;
; DC Motor Differential Drive Controller
; For Raspberry Pi Pico
;

[platformio]
default_envs = pico

; ============================================
; Common settings
; ============================================
[common]
monitor_speed = 115200

; ============================================
; Raspberry Pi Pico (Production)
; Uses Earle Philhower's arduino-pico core
; ============================================
[env:pico]
platform = https://github.com/maxgerhardt/platform-raspberrypi.git
board = pico
framework = arduino
board_build.core = earlephilhower
monitor_speed = ${common.monitor_speed}
lib_deps =
    khoih-prog/RPI_PICO_TimerInterrupt@^1.3.1
    bakercp/PacketSerial@^1.4.0

; ============================================
; Raspberry Pi Pico (Debug)
; Debug Probe（cmsis-dap）経由でSWDデバッグ
; Serial1（GPIO0/1）でデバッグログ出力
; ============================================
[env:pico_debug]
platform = https://github.com/maxgerhardt/platform-raspberrypi.git
board = pico
framework = arduino
board_build.core = earlephilhower
monitor_speed = ${common.monitor_speed}
lib_deps =
    khoih-prog/RPI_PICO_TimerInterrupt@^1.3.1
    bakercp/PacketSerial@^1.4.0

; デバッグ設定
debug_tool = cmsis-dap
debug_init_break = tbreak setup
upload_protocol = cmsis-dap

; デバッグビルドフラグ
build_flags =
    -DDEBUG_BUILD
    -g3
    -O0

; デバッグ用Serial1モニタ（Debug ProbeのUART経由）
monitor_port = /dev/cu.usbmodem*
monitor_filters = direct

; ============================================
; Native Test Environment (PC)
; For running unit tests on development machine
; ============================================
[env:native]
platform = native
test_framework = unity
build_flags =
    -std=c++17
    -DUNIT_TEST
lib_deps =
    throwtheswitch/Unity@^2.6.0
lib_ignore =
    CugoSDK
test_ignore = test_embedded
